{"version":3,"file":"bundle.umd.js","sources":["../eagle-sdk/perf.js","../eagle-sdk/index.js"],"sourcesContent":["// 过滤无效数据；\nfunction filterTime(a, b) {\n    return (a > 0 && b > 0 && (a - b) >= 0) ? (a - b) : undefined;\n}\nfunction maxBy(array, type) {\n    let result = 0\n    if (array == null) {\n        return result\n    }\n    for (const value of array) {\n        let current = value[type]\n        if (current != null && current > result) {\n            result = current\n        }\n    }\n    return result\n}\nexport default {\n    init: (cb) => {\n        let isDOMReady = false\n        let isOnload = false\n        let cycleTime = 100\n        let performance = window.performance || window.mozPerformance || window.msPerformance || window.webkitPerformance;\n        // console.log(performance.getEntries()) //这里是获取不到first-contentful-paint渲染信息的\n        let Util = {\n            getPerfData: () => {\n                let entries = performance.getEntries()\n                if (entries.length) {\n                    entries = entries.filter((item, i) => {\n                        return item.entryType !== 'paint'\n                    })\n                }\n\n                let data = {\n                    firstContentfulPaint: Math.round(performance.getEntriesByName('first-contentful-paint')[0].startTime),\n                    completeLoaded: Math.round(maxBy(entries, 'responseEnd'))\n                }\n                return data\n            },\n            domReady: (callback) => { //DOM解析完成\n                if (isDOMReady) return\n                let timer = null\n                let runCheck = () => {\n                    if (performance.timing.domComplete) {\n                        clearTimeout(timer);\n                        callback();\n                        isDOMReady = true;\n                    } else {\n                        timer = setTimeout(runCheck, cycleTime);\n                    }\n                }\n                if (document.readyState === 'interactive') {\n                    runCheck()\n                    return\n                }\n\n                document.addEventListener('DOMContentLoaded', () => {\n                    // 开始循环检查DOMContentLoaded是否完成\n                    runCheck();\n                })\n\n            },\n            onload: (callback) => { //页面加载完成\n                if (isOnload) return\n                let timer = null\n                let runCheck = () => {\n                    if (performance.timing.loadEventEnd) {\n                        clearTimeout(timer);\n                        callback();\n                        isOnload = true;\n                    } else {\n                        timer = setTimeout(runCheck, cycleTime);\n                    }\n                }\n                if (document.readyState === 'interactive') {\n                    runCheck()\n                    return\n                }\n\n                window.addEventListener('load', () => {\n                    runCheck()\n                })\n            }\n        }\n        Util.domReady(() => {\n            let perfData = Util.getPerfData() //拿到性能数据\n            perfData.type = 'domReady'\n            cb(perfData)\n        })\n        Util.onload(() => {\n            let perfData = Util.getPerfData(performance.timing) //拿到性能数据\n            perfData.type = 'onload'\n            cb(perfData)\n        })\n    }\n}","import perf from './perf'\n\n\nperf.init((perfData) => {\n    console.log('perf init')\n    console.log(perfData)\n})\n\n"],"names":[],"mappings":"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"}