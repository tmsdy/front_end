{"version":3,"file":"bundle.umd.js","sources":["../../../../eagle-sdk/perf.js","../../../../eagle-sdk/index.js"],"sourcesContent":["\nfunction maxBy(array, type) {\n    let result = 0\n    if (array == null) {\n        return result\n    }\n    for (const value of array) {\n        let current = value[type]\n        if (current != null && current > result) {\n            result = current\n        }\n    }\n    return result\n}\nexport default {\n    init: (cb) => {\n        let isDOMReady = false\n        let cycleTime = 20\n        let performance = window.performance || window.mozPerformance || window.msPerformance || window.webkitPerformance\n        // console.log(performance.getEntries()) //这里是获取不到first-contentful-paint渲染信息的\n        let Util = {\n            addEventListener: function (name, callback, useCapture) {\n                if (window.addEventListener) {\n                    return window.addEventListener(name, callback, useCapture)\n                } else if (window.attachEvent) {\n                    return window.attachEvent('on' + name, callback)\n                }\n            },\n            getPerfData: () => {\n                let entries = performance.getEntries()\n                if (entries.length) {\n                    entries = entries.filter((item, i) => {\n                        return item.entryType !== 'paint'\n                    })\n                }\n\n                let data = {\n                    firstContentfulPaint: Math.round(performance.getEntriesByName('first-contentful-paint')[0].startTime),\n                    completeLoaded: Math.round(maxBy(entries, 'responseEnd'))\n                }\n                return data\n            },\n            domReady: (callback) => { // DOM解析完成\n                if (isDOMReady) {\n                    isDOMReady = false\n                    return\n                }\n                if (document.readyState === 'complete') {\n                    callback()\n                }\n                let timer = null\n                let runCheck = () => {\n                    if (performance.timing.domComplete) {\n                        clearTimeout(timer)\n                        callback()\n                        isDOMReady = true\n                    } else {\n                        timer = setTimeout(runCheck, cycleTime)\n                    }\n                }\n                if (document.readyState === 'interactive') {\n                    runCheck()\n                } else if (document.addEventListener) {\n                    document.addEventListener('load', function () {\n                        runCheck()\n                    }, false)\n                } else if (document.attachEvent) {\n                    document.attachEvent('onreadystatechange', function () {\n                        runCheck()\n                    })\n                }\n\n                document.addEventListener('DOMContentLoaded', () => {\n                    // 开始循环检查DOMContentLoaded是否完成\n                    runCheck()\n                })\n            }\n        }\n        console.log('Util.domReady')\n        Util.domReady(() => {\n            let perfData = Util.getPerfData() // 拿到性能数据\n            console.log(perfData)\n            cb(perfData)\n        })\n    }\n}\n","import perf from './perf'\n\n\nperf.init((perfData) => {\n    console.log('perf init')\n    console.log(perfData)\n})\n\n"],"names":[],"mappings":"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"}