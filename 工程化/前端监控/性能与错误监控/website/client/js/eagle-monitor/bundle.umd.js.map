{"version":3,"file":"bundle.umd.js","sources":["../../../../eagle-sdk/errorCatch.js","../../../../eagle-sdk/index.js"],"sourcesContent":["let formatStack = (stack) => {\n    let matchUrl = stack.match(/https?:\\/\\/[^\\n]+/) //报错url和报错位置\n    // console.log(matchUrl)\n    let urlFirstStack = matchUrl ? matchUrl[0] : ''\n    let regUrlCheck = /https?:\\/\\/(\\S)*\\.js/\n\n    let resourceUrl = '' //报错url\n    if (regUrlCheck.test(urlFirstStack)) {\n        resourceUrl = urlFirstStack.match(regUrlCheck)[0]\n    }\n\n    let stackCol = null //报错信息列\n    let stackRow = null //报错信息行\n    let posStack = urlFirstStack.match(/:(\\d+):(\\d+)/)\n    if (posStack && posStack.length >= 3) {\n        [, stackCol, stackRow] = posStack\n    }\n    return {\n        resourceUrl,\n        stackCol,\n        stackRow\n    }\n}\nlet formatError = (errorObj) => {\n    // console.log(errorObj)\n    let col = errorObj.column || errorObj.columnNumber\n    let row = errorObj.line || errorObj.lineNumber\n    let errorType = errorObj.name\n    let message = errorObj.message\n\n    let { stack } = errorObj\n    if (stack) {\n        // console.log(stack)\n        let { resourceUrl, stackCol, stackRow } = formatStack(stack)\n\n        return {\n            content: stack,\n            col: Number(col || stackCol),\n            row: Number(row || stackRow),\n            errorType,\n            message,\n            resourceUrl\n        }\n        // debugger\n    }\n    // debugger\n}\n\nexport default {\n    init: (cb) => {\n        let _origin_error = window.onerror\n        console.log('errorCatch 开始监听')\n        window.onerror = function (message, source, lineno, colno, error) {\n            let errorInfo = formatError(error)\n            errorInfo._message = message\n            errorInfo._source = source\n            errorInfo._lineno = lineno\n            errorInfo._colno = colno\n\n            cb(errorInfo)\n\n            errorInfo.type = 'error'\n            _origin_error && _origin_error.apply(window, arguments)\n\n        }\n        // 针对 vue 报错重写 console.error\n        // TODO\n        console.error = (function (origin) {\n            return function (info) {\n                let stack = info.stack\n                let { resourceUrl, stackCol, stackRow } = formatStack(stack)\n                console.log(resourceUrl, stackCol, stackRow)\n                origin.call(console, info);\n            }\n        })(console.error);\n    }\n}\n","// import perf from './perf'\n// perf.init((perfData) => {\n//     console.log('perf init')\n//     console.log(perfData)\n// })\n\nimport errorCatch from './errorCatch'\n\nerrorCatch.init(errorInfo => {\n    console.log('errorInfo', errorInfo)\n})\n\n"],"names":[],"mappings":"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"}